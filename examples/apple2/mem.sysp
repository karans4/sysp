;; mem.sysp — Apple II 64KB memory map

(defn mem-read [mem, addr]
  ;; $C010: keyboard strobe — any read clears bit 7 of $C000
  (when (== addr 49168)
    (ptr-set! mem 49152 (& (ptr-deref mem 49152) 127)))
  (ptr-deref mem addr))

(defn mem-write [mem, addr, val]
  (ptr-set! mem addr val))

(defn mem-read16 [mem, addr]
  (+ (mem-read mem addr)
     (<< (mem-read mem (+ addr 1)) 8)))
